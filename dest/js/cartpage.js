"use strict";$(function(){$.ajax({url:"/selectcart",type:"get",success:function(c){var t=(c=JSON.parse(c)).map(function(c){return'  <div class="shops" data-id="'.concat(c.shopID,'">\n                             <div class="checkbox">\n                                 <input type="checkbox" ').concat(1==c.isActive?"checked=checked":"",'>\n                             </div>\n                             <div class="shopName">\n                                 <div class="dflex">\n                                     <img src="').concat(c.img,'" alt="">\n                                     <p> ').concat(c.shopname,'</p>\n                                 </div>\n                             </div>\n                             <div style="width:200px;height:100%;"></div>\n                             <div class="prices">\n                                 ¥  <span>   ').concat(c.price,'</span>\n                             </div>\n                             <div class="num">\n                                 <div class="num_box">\n                                     <span>-</span>\n                                     <input type="text" value="').concat(c.totalnum,'">\n                                     <span>+</span>\n                                 </div>\n                             </div>\n                             <div class="sum">\n                                 ¥<span> ').concat(c.price*c.totalnum,'</span>\n                             </div>\n                             <div class="del">\n                                 <span>删除</span>\n                             </div>\n                         </div>')}).join("");$(".section4 .center").html(t);var u=$(".section5 .rightss a"),e=0;function s(){var e=0;$(".section4 .shops .checkbox input").each(function(c,t){$(t).prop("checked")&&e++}),e==$(".section4 .shops .checkbox input").length?($(".section3 input").prop("checked","checked"),$(".section5 .checkb input").prop("checked","checked")):($(".section3 input").prop("checked",""),$(".section5 .checkb input").prop("checked",""))}$(".section4 .shops .checkbox input").each(function(c,t){$(t).prop("checked")&&(e+=1*$(t).parents(".checkbox").siblings(".sum").find("span").text(),u.text(e))}),u.text(e),s(),$(".section3 input").click(function(){var e=0;$(this).prop("checked")?($.ajax({url:"/updateActive",data:{allShop:"all"}}),$(".section4 .shops .checkbox input").each(function(c,t){$(t).prop("checked","checked"),$(".section5 .checkb input").prop("checked","checked")}),$(".section4 .shops .sum span").each(function(c,t){e+=1*t.innerText,u.text(e)})):($.ajax({url:"/updateActive",data:{allShop:"noAll"}}),$(".section4 .shops .checkbox input").each(function(c,t){$(t).prop("checked",""),$(".section5 .checkb input").prop("checked",""),u.text(0)}))}),$(".section5 .checkb input").click(function(){var e=0;$(this).prop("checked")?($.ajax({url:"/updateActive",data:{allShop:"all"}}),$(".section4 .shops .checkbox input").each(function(c,t){$(t).prop("checked","checked"),$(".section3 input").prop("checked","checked")}),$(".section4 .shops .sum span").each(function(c,t){e+=1*t.innerText,u.text(e)})):($.ajax({url:"/updateActive",data:{allShop:"noAll"}}),$(".section4 .shops .checkbox input").each(function(c,t){$(t).prop("checked",""),$(".section3 input").prop("checked",""),u.text(0)}))}),$(".section4 ").on("click"," .shops .checkbox input",function(){var c=$(this).parents(".shops").data("id"),t=0;t=$(this).prop("checked")?1:0,$.ajax({url:"/updateActive",data:{shopsID:c,isActive:t,allShop:"no"}});var e=1*$(this).parents(".checkbox").siblings(".sum").find("span").text(),n=0;n=$(this).prop("checked")?1*u.text()+e:1*u.text()-e,u.text(n),s()}),$(".num").on("click","span",function(c){c.stopPropagation();var t=$(this).siblings("input"),e=1*t.val(),n=$(this).parents(".num").siblings(".sum").find("span"),s=(n.text(),1*$(this).parents(".num").siblings(".prices").find("span").text()),i=$(this).parents(".num").siblings(".checkbox").find("input"),p=$(this).parents(".shops").data("id");if("+"==$(this).text()){e+=1,t.val(e),n.text(s*e);var a=e;if($.ajax({url:"/updateShopNum",data:{shopsID:p,shopNum:a}}),i.prop("checked")){var o=s+1*u.text();u.text(o)}}else{if(0==e)return;e-=1,t.val(e),n.text(s*e);var h=e;if($.ajax({url:"/updateShopNum",data:{shopsID:p,shopNum:h}}),i.prop("checked")){var d=1*u.text()-s;u.text(d)}}}),$(".section4 ").on("click",".del span",function(){var c=$(this).parents(".shops").data("id");if($.ajax({url:"/delData",data:{shopsID:c}}),$(this).parents(".shops").remove(),$(this).parent().siblings(".checkbox").find("input").prop("checked")){var t=1*u.text()-1*$(this).parent().siblings(".sum").find("span").text();u.text(t)}s()}),$(".section5 .fl_ul p").eq(1).click(function(){$(".section4 .center").html("清空操作"),$(".section3 input").prop("checked",""),$(".section5 .checkb input").prop("checked",""),$.ajax({url:"/delData",data:{shopsID:"all"},success:function(c){window.location.reload()}})}),$(".section5 .fl_ul p").eq(0).click(function(){var n=[];$(".section4 .shops .checkbox input").each(function(c,t){if($(t).prop("checked")){var e=$(this).parents(".shops").data("id");n.push(e),$(t).parents(".shops").remove()}}),$.ajax({url:"/delData",data:{shopsID:n},success:function(c){window.location.reload()}})})}})});